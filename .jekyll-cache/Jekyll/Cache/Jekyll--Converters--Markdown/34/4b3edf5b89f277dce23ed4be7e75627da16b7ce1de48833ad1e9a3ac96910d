I"{<p><a href="./">Home</a></p>

<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/rhG1gG7Dblc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
<p><br /></p>
<blockquote>
  <p><strong>If you remember our <em><a href="./#the-final-goal">The Final Goal</a></em>, it is the time to start working on that.</strong></p>
</blockquote>

<h2 id="problem-statement">Problem Statement</h2>

<p>The system is due to a problem from the classic Goldstein. The problem follows:</p>
<blockquote>
  <p>“The point of suspension of a simple pendulum of length l and the mass m is constrained to move on a parabola \( z=ax^2 \) in the verticle plane. Derive the Hamiltonian governing the motion of pendulum and its point of suspension. Obtain the Hamilton’s equation of motion.” [Ref: Goldstein, Herbert &amp; Poole, Charles &amp; Safko, John. (3rd Ed). Classical Mechanics by H. Goldstein, C. Poole, and J. Safko. (Ch. 8, P. 19)]</p>
</blockquote>

<p>Here our goal is to find the equation of motions, to solve them within the GNUPlot script, and to simulate the system directly there to produce the above GIF. On the next page we will see how to solve a problem in a programming language and use the saved data to produce such GIF with an example system - <em>Kapitza Pendulum</em>.</p>

<h2 id="working-equations">Working Equations</h2>

<p>After a tedious algebra(see below) one can find the equation of motion from the Lagrangian. One may use Hamilton’s equation of motion, but some of the expressions are too long and complicated, so I decided to continue with Lagrangian. Although the computational complexity remains the same because in both cases you have to solve four coupled first-order differential equations.</p>

<p>–Equations–</p>

<p>To apply numerical methods (We will be using <a href="#">Runge-Kutta 4-th order</a> method), we need to convert them to the first order.</p>

<p>–equations–</p>

<ul>
  <li>First few minutes are recommended of this <a href="https://youtu.be/nh4TFzg30eQ">lecture</a> (8:46-11:12) by V. Balakrishnan if you’re not familiar with such exercise. Here you’ll find an illuminating explanation.</li>
</ul>

<h1 id="few-remarks-on-function">Few remarks on function</h1>

<p>In the last page, we’ve seen how to create a function, it’s easy! <code class="language-plaintext highlighter-rouge">function_name(arguments) = expression/statement</code></p>

<p>Here we will use functions not only for the mathematical expressions but also for the printing purpose - like parameters, initial conditions, and title. The functions will look like</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># a function to print title and time

ptime(tr) = sprintf("{A pendulum is costrained to move}\n {on a parabola z=ax^2}\n\
{/Times:Italic t} = %5.2f [s]", tr)

# Print parameters

pparam(p, q, r, s, t) = sprintf("\
{/Times:Bold Parameters}\n\
{/Times:Italic m} = %.2f [kg]\n\
{/Times:Italic a} = %.2f (z=ax^2)\n\
{/Times:Italic l} = %3.1f [m]\n\
{/Times:Italic g} = %3.2f [m/s^2]\n\
{/Times:Italic dt} = %.2f [s]\n", p, q, r, s, t) 

#Print initial conditions

pini(a, b, c, d) = sprintf("\
{/Times:Bold Initial Conditions}\n\
{/Times:Italic x} = %.2f [m]\n\
{/Times:Italic theeta} = %3.2f [rad] \n\
{/Times:Italic x-dot} = %.2f [m/s]\n\
{/Times:Italic theeta-dot} = %.2f [rad/s]\n", a, b, c, d) 
</code></pre></div></div>
<p>The ‘' character is understood as the continuation of the same statement. And the working of function <code class="language-plaintext highlighter-rouge">sprintf</code> is the same as of <code class="language-plaintext highlighter-rouge">printf</code> in CPP. The braces may be used for fonts, to put greek symbols, etc.</p>

<h2 id="wrapping-up-the-final-code">Wrapping up The Final Code</h2>

<p>Now we are ready to put things together. As always, I’ll put comments within the code to explain things ~</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>code
</code></pre></div></div>
<h2 id="appendix-1---derivation-of-lagrangian-hamiltonian-and-eom-for-the-system">Appendix 1 - Derivation of Lagrangian, Hamiltonian, and EOM for the system</h2>

<p>bla bla bla</p>

<h2 id="appendix-2---rk-4-method">Appendix 2 - RK-4 method</h2>

<p>bla bla bla</p>

:ET